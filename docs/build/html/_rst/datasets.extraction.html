<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>datasets.extraction package &mdash; open-mimic-iii - documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=b1628c55"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="datasets.processors package" href="datasets.processors.html" />
    <link rel="prev" title="datasets package" href="datasets.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            open-mimic-iii
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="datasets.html">datasets package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="datasets.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">datasets.extraction package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-datasets.extraction.event_consumer">datasets.extraction.event_consumer module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-datasets.extraction.event_producer">datasets.extraction.event_producer module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-datasets.extraction.extraction_functions">datasets.extraction.extraction_functions module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-datasets.extraction.progress_publisher">datasets.extraction.progress_publisher module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-datasets.extraction.timeseries_processor">datasets.extraction.timeseries_processor module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-datasets.extraction">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="datasets.processors.html">datasets.processors package</a></li>
<li class="toctree-l3"><a class="reference internal" href="datasets.split.html">datasets.split package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="datasets.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="datasets.html#module-datasets.discretizing">datasets.discretizing module</a></li>
<li class="toctree-l2"><a class="reference internal" href="datasets.html#module-datasets.mimic_utils">datasets.mimic_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="datasets.html#module-datasets.readers">datasets.readers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="datasets.html#module-datasets.trackers">datasets.trackers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="datasets.html#module-datasets.writers">datasets.writers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="datasets.html#module-datasets">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="generators.html">generators package</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">metrics package</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">models package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pipelines.html">pipelines package</a></li>
<li class="toctree-l1"><a class="reference internal" href="preprocessing.html">preprocessing package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">open-mimic-iii</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="datasets.html">datasets package</a></li>
      <li class="breadcrumb-item active">datasets.extraction package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_rst/datasets.extraction.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="datasets-extraction-package">
<h1>datasets.extraction package<a class="headerlink" href="#datasets-extraction-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-datasets.extraction.event_consumer">
<span id="datasets-extraction-event-consumer-module"></span><h2>datasets.extraction.event_consumer module<a class="headerlink" href="#module-datasets.extraction.event_consumer" title="Link to this heading"></a></h2>
<p>This module provides classes for processing subject events from the raw CHARTEVENT, LABEVENTS and OUTPUTEVENTS csv and store it by subject.
This class is used for multiprocessing and employed by the iterative extraction. The preprocessing is done by
the datasets.extraction.extraction_functions.extract_subject_events, this class handle the multiprocessing chain.</p>
<section id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Link to this heading"></a></h3>
<ul class="simple">
<li><dl class="simple">
<dt>EventConsumer(storage_path, in_q, out_q, icu_history_df, lock)</dt><dd><p>Consumes events from a queue, processes them, and writes to storage.</p>
</dd>
</dl>
</li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">multiprocess</span> <span class="kn">import</span> <span class="n">JoinableQueue</span><span class="p">,</span> <span class="n">Lock</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">some_module</span> <span class="kn">import</span> <span class="n">EventConsumer</span><span class="p">,</span> <span class="n">EventReader</span><span class="p">,</span> <span class="n">ExtractionTracker</span>

<span class="c1"># Initialize parameters</span>
<span class="n">storage_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;/path/to/storage&#39;</span><span class="p">)</span>
<span class="n">in_q</span> <span class="o">=</span> <span class="n">JoinableQueue</span><span class="p">()</span>
<span class="n">out_q</span> <span class="o">=</span> <span class="n">JoinableQueue</span><span class="p">()</span>
<span class="n">icu_history_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/path/to/icu_history.csv&#39;</span><span class="p">)</span>
<span class="n">tracker</span> <span class="o">=</span> <span class="n">ExtractionTracker</span><span class="p">(</span><span class="n">storage_path</span><span class="p">)</span>

<span class="c1"># Create and start the consumer</span>
<span class="n">consumer</span> <span class="o">=</span> <span class="n">EventConsumer</span><span class="p">(</span><span class="n">storage_path</span><span class="o">=</span><span class="n">storage_path</span><span class="p">,</span>
                         <span class="n">in_q</span><span class="o">=</span><span class="n">in_q</span><span class="p">,</span>
                         <span class="n">out_q</span><span class="o">=</span><span class="n">out_q</span><span class="p">,</span>
                         <span class="n">icu_history_df</span><span class="o">=</span><span class="n">icu_history_df</span><span class="p">,</span>
                         <span class="n">lock</span><span class="o">=</span><span class="n">tracker</span><span class="o">.</span><span class="n">_lock</span><span class="p">)</span>
<span class="n">consumer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="c1"># Create the event reader and get a chunk of data</span>
<span class="n">event_reader</span> <span class="o">=</span> <span class="n">EventReader</span><span class="p">(</span><span class="n">dataset_folder</span><span class="o">=</span><span class="s1">&#39;/path/to/data&#39;</span><span class="p">,</span>
                           <span class="n">chunksize</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
<span class="n">event_frames</span><span class="p">,</span> <span class="n">frame_lengths</span> <span class="o">=</span> <span class="n">event_reader</span><span class="o">.</span><span class="n">get_chunk</span><span class="p">()</span>
<span class="n">events_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">event_frames</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Put the data into the queue and join the consumer</span>
<span class="n">in_q</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">events_df</span><span class="p">,</span> <span class="n">frame_lengths</span><span class="p">))</span>
<span class="n">consumer</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</pre></div>
</div>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="datasets.extraction.event_consumer.EventConsumer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datasets.extraction.event_consumer.</span></span><span class="sig-name descname"><span class="pre">EventConsumer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">storage_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">JoinableQueue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">JoinableQueue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icu_history_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lock</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Lock</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/event_consumer.html#EventConsumer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.event_consumer.EventConsumer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Process</span></code></p>
<p>A process that consumes events from a queue, processes them, and writes the results to storage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>storage_path</strong> (<em>Path</em>) – Path to the storage directory where the processed data will be saved.</p></li>
<li><p><strong>in_q</strong> (<em>JoinableQueue</em>) – Queue from which to read the events to process.</p></li>
<li><p><strong>out_q</strong> (<em>JoinableQueue</em>) – Queue to which the processed events are sent.</p></li>
<li><p><strong>icu_history_df</strong> (<em>pd.DataFrame</em>) – DataFrame containing ICU history information.</p></li>
<li><p><strong>lock</strong> (<em>Lock</em>) – Lock to manage access to shared resources.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="datasets.extraction.event_consumer.EventConsumer.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/event_consumer.html#EventConsumer.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.event_consumer.EventConsumer.run" title="Link to this definition"></a></dt>
<dd><p>Runs the consumer process, processing events from the queue.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasets.extraction.event_consumer.EventConsumer._make_subject_events">
<span class="sig-name descname"><span class="pre">_make_subject_events</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chartevents_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icu_history_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/event_consumer.html#EventConsumer._make_subject_events"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.event_consumer.EventConsumer._make_subject_events" title="Link to this definition"></a></dt>
<dd><p>Creates subject events from chartevents and ICU history data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasets.extraction.event_consumer.EventConsumer.start">
<span class="sig-name descname"><span class="pre">start</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/event_consumer.html#EventConsumer.start"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.event_consumer.EventConsumer.start" title="Link to this definition"></a></dt>
<dd><p>Starts the consumer process.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasets.extraction.event_consumer.EventConsumer.join">
<span class="sig-name descname"><span class="pre">join</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/event_consumer.html#EventConsumer.join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.event_consumer.EventConsumer.join" title="Link to this definition"></a></dt>
<dd><p>Joins the consumer process.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">join</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/event_consumer.html#EventConsumer.join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Wait until child process terminates</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/event_consumer.html#EventConsumer.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd><p>Method to be run in sub-process; can be overridden in sub-class</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">start</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/event_consumer.html#EventConsumer.start"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd><p>Start child process</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-datasets.extraction.event_producer">
<span id="datasets-extraction-event-producer-module"></span><h2>datasets.extraction.event_producer module<a class="headerlink" href="#module-datasets.extraction.event_producer" title="Link to this heading"></a></h2>
<section id="dataset-extraction-module">
<h3>Dataset Extraction Module<a class="headerlink" href="#dataset-extraction-module" title="Link to this heading"></a></h3>
<p>This module provides the EventProducer class for reading and processing subject events from the raw CHARTEVENT, LABEVENTS and OUTPUTEVENTS CSVs and
handling their processing into subject events. It supports both compact and iterative extraction methods to handle different use cases.</p>
<p><strong>Subject Events</strong>: A dictionary where each key is a subject ID, and the value is a DataFrame of
chart events (e.g., lab results, vital signs) associated with that subject.</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>From</strong>: CHARTEVENTS, LABEVENTS, OUTPUTEVENTS</p></li>
<li><p><strong>In</strong>: evenet_consumer.py</p></li>
<li><dl class="simple">
<dt><strong>Cols</strong>:</dt><dd><ul>
<li><p>SUBJECT_ID</p></li>
<li><p>HADM_ID</p></li>
<li><p>ICUSTAY_ID</p></li>
<li><p>CHARTTIME</p></li>
<li><p>ITEMID</p></li>
<li><p>VALUE</p></li>
<li><p>VALUEUOM</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<section id="id3">
<h4>Classes<a class="headerlink" href="#id3" title="Link to this heading"></a></h4>
<ul class="simple">
<li><dl class="simple">
<dt>EventProducer(source_path, storage_path, num_samples, chunksize, tracker, icu_history_df, subject_ids)</dt><dd><p>Produces events by reading data from source, processing it, and passing it to consumers.</p>
</dd>
</dl>
</li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">some_module</span> <span class="kn">import</span> <span class="n">EventProducer</span><span class="p">,</span> <span class="n">ExtractionTracker</span>

<span class="c1"># Initialize parameters</span>
<span class="n">source_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;/path/to/source&#39;</span><span class="p">)</span>
<span class="n">storage_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;/path/to/storage&#39;</span><span class="p">)</span>
<span class="n">chunksize</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">icu_history_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/path/to/icu_history.csv&#39;</span><span class="p">)</span>
<span class="n">tracker</span> <span class="o">=</span> <span class="n">ExtractionTracker</span><span class="p">(</span><span class="n">storage_path</span><span class="p">)</span>
<span class="n">subject_ids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1234</span><span class="p">,</span> <span class="mi">1235</span><span class="p">,</span> <span class="mi">1236</span><span class="p">,</span> <span class="mi">1237</span><span class="p">,</span> <span class="mi">1238</span><span class="p">]</span>

<span class="c1"># Create and run the producer</span>
<span class="n">producer</span> <span class="o">=</span> <span class="n">EventProducer</span><span class="p">(</span><span class="n">source_path</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">,</span> <span class="n">chunksize</span><span class="p">,</span> <span class="n">tracker</span><span class="p">,</span> <span class="n">icu_history_df</span><span class="p">,</span> <span class="n">subject_ids</span><span class="p">)</span>
<span class="n">producer</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="datasets.extraction.event_producer.EventProducer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datasets.extraction.event_producer.</span></span><span class="sig-name descname"><span class="pre">EventProducer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunksize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracker</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="datasets.html#datasets.trackers.ExtractionTracker" title="datasets.trackers.ExtractionTracker"><span class="pre">ExtractionTracker</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">icu_history_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subject_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/event_producer.html#EventProducer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.event_producer.EventProducer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Produces events by reading data from the source, processing it, and passing it to consumers.
The class handles the processing chain, that is the producer spawn event consumers and the progress publisher.
It reads the events from the LABOUTPUTS, CHARTEVENTS and OUTPUTEVENTS CSV’s and passes them via
queues to the event consumer, which passes its progress to the progress publisher. Once dones,
the producer joins all other processes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_path</strong> (<em>Path</em>) – Path to the source directory containing the raw data files.</p></li>
<li><p><strong>storage_path</strong> (<em>Path</em>) – Path to the storage directory where the processed data will be saved.</p></li>
<li><p><strong>num_samples</strong> (<em>int</em>) – Number of samples to process.</p></li>
<li><p><strong>chunksize</strong> (<em>int</em>) – Size of chunks to read at a time.</p></li>
<li><p><strong>tracker</strong> (<a class="reference internal" href="datasets.html#datasets.trackers.ExtractionTracker" title="datasets.trackers.ExtractionTracker"><em>ExtractionTracker</em></a>) – Tracker to keep track of extraction progress.</p></li>
<li><p><strong>icu_history_df</strong> (<em>pd.DataFrame</em>) – DataFrame containing ICU history information.</p></li>
<li><p><strong>subject_ids</strong> (<em>list</em><em> of </em><em>int</em><em>, </em><em>optional</em>) – List of subject IDs to process. If None, all subjects are processed. Default is None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="datasets.extraction.event_producer.EventProducer.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/event_producer.html#EventProducer.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.event_producer.EventProducer.run" title="Link to this definition"></a></dt>
<dd><p>Starts the event production process, reading data, processing it, and passing it to consumers.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasets.extraction.event_producer.EventProducer._count_timeseries_sample">
<span class="sig-name descname"><span class="pre">_count_timeseries_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">varmap_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/event_producer.html#EventProducer._count_timeseries_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.event_producer.EventProducer._count_timeseries_sample" title="Link to this definition"></a></dt>
<dd><p>Counts the number of unique time series samples in a DataFrame.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasets.extraction.event_producer.EventProducer._update_total_lengths">
<span class="sig-name descname"><span class="pre">_update_total_lengths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts_lengths</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/event_producer.html#EventProducer._update_total_lengths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.event_producer.EventProducer._update_total_lengths" title="Link to this definition"></a></dt>
<dd><p>Updates the total lengths of time series samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/event_producer.html#EventProducer.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-datasets.extraction.extraction_functions">
<span id="datasets-extraction-extraction-functions-module"></span><h2>datasets.extraction.extraction_functions module<a class="headerlink" href="#module-datasets.extraction.extraction_functions" title="Link to this heading"></a></h2>
<section id="extraction-functions-module">
<h3>Extraction Functions Module<a class="headerlink" href="#extraction-functions-module" title="Link to this heading"></a></h3>
<p>This module provides functions for extracting and processing ICU event data into a structured format.
The functions are used for both compact and iterative extraction processes. Compact extraction calls
them from the __init__.py, while iterative calls them from the event_producer.py and timeseries_processor.py.</p>
<p>The primary output of these functions includes three main components:</p>
<ol class="arabic">
<li><p><strong>Subject Events</strong>: A dictionary where each key is a subject ID, and the value is a DataFrame of
chart events (e.g., lab results, vital signs) associated with that subject.</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>From</strong>: CHARTEVENTS, LABEVENTS, OUTPUTEVENTS</p></li>
<li><p><strong>In</strong>: evenet_consumer.py</p></li>
<li><dl class="simple">
<dt><strong>Cols</strong>:</dt><dd><ul>
<li><p>SUBJECT_ID</p></li>
<li><p>HADM_ID</p></li>
<li><p>ICUSTAY_ID</p></li>
<li><p>CHARTTIME</p></li>
<li><p>ITEMID</p></li>
<li><p>VALUE</p></li>
<li><p>VALUEUOM</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</li>
<li><p><strong>Timeseries Data</strong>: A dictionary where each key is a subject ID, and the value is another dictionary.
The inner dictionary maps each ICU stay ID to a DataFrame of time series data, containing recorded
events for specified variables (e.g., heart rate, blood pressure) indexed by time.</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>From</strong>: icu history, subject events, varmap</p></li>
<li><p><strong>In</strong>: timeseries_processor.py</p></li>
<li><dl class="simple">
<dt><strong>Cols</strong>:</dt><dd><ul>
<li><p>Capillary refill rate</p></li>
<li><p>Diastolic blood pressure</p></li>
<li><p>Fraction inspired oxygen</p></li>
<li><p>Glascow coma scale eye opening</p></li>
<li><p>Glascow coma scale motor response</p></li>
<li><p>Glascow coma scale total</p></li>
<li><p>Glascow coma scale verbal response</p></li>
<li><p>Glucose</p></li>
<li><p>Heart Rate</p></li>
<li><p>Height</p></li>
<li><p>Mean blood pressure</p></li>
<li><p>Oxygen saturation</p></li>
<li><p>pH</p></li>
<li><p>Respiratory rate</p></li>
<li><p>Systolic blood pressure</p></li>
<li><p>Temperature</p></li>
<li><p>Weight</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</li>
<li><p><strong>Episodic Data</strong>: A dictionary where each key is a subject ID, and the value is a DataFrame of
episodic data, summarizing each ICU stay with patient-specific and stay-specific information
(e.g., age, length of stay, mortality, gender, ethnicity, height, weight, and diagnoses).</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>From</strong>: icu history, subject events, diagnoses</p></li>
<li><p><strong>In</strong>: timeseries_processor.py</p></li>
<li><dl class="simple">
<dt><strong>Cols</strong>:</dt><dd><ul>
<li><p>ICU Stay ID</p></li>
<li><p>Age</p></li>
<li><p>Length of Stay (LOS)</p></li>
<li><p>Mortality</p></li>
<li><p>Gender</p></li>
<li><p>Ethnicity</p></li>
<li><p>Height</p></li>
<li><p>Weight</p></li>
<li><p>Diagnoses binaries as columns</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</li>
</ol>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="datasets.extraction.extraction_functions.extract_episodic_data">
<span class="sig-prename descclassname"><span class="pre">datasets.extraction.extraction_functions.</span></span><span class="sig-name descname"><span class="pre">extract_episodic_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subject_icu_history</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="../_modules/datasets/extraction/extraction_functions.html#extract_episodic_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.extraction_functions.extract_episodic_data" title="Link to this definition"></a></dt>
<dd><p>Create episodic data from subject ICU history.</p>
<p>This method processes the ICU history of subjects to create a DataFrame containing episodic data for each ICU stay.
The episodic data includes per ICU stay:
- ID
- age
- length of stay
- mortality
- gender
- ethnicity
- height
- weight</p>
<p>Gender and ethnicity are imputed using predefined mappings if they are missing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>subject_icu_history</strong> (<em>pd.DataFrame</em>) – DataFrame containing the subject ICU history.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame containing episodic data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="datasets.extraction.extraction_functions.extract_subject_events">
<span class="sig-prename descclassname"><span class="pre">datasets.extraction.extraction_functions.</span></span><span class="sig-name descname"><span class="pre">extract_subject_events</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chartevents_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icu_history_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/extraction_functions.html#extract_subject_events"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.extraction_functions.extract_subject_events" title="Link to this definition"></a></dt>
<dd><p>Extracts and processes chartevent data into a dictionary of events by subject.</p>
<p>This method processes the input DataFrame containing chartevent from the OUTPUTEVENTS, LABEVENTS or INPUTEVENTS CSV’s
and merges it with the ICU stay history data to create a structured dictionary of events per subject and stay ID.
It filters and aligns the chartevents with the corresponding ICU stays, ensuring that each event is correctly associated with
the appropriate ICU stay and subject, as some events might not include these IDs. If not ICUSTAY_ID could be found,
the data is dropped.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chartevents_df</strong> (<em>pd.DataFrame</em>) – DataFrame containing chartevent data from ICU.</p></li>
<li><p><strong>icu_history_df</strong> (<em>pd.DataFrame</em>) – DataFrame containing ICU stay data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing chartevents per subject ID.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="datasets.extraction.extraction_functions.extract_timeseries">
<span class="sig-prename descclassname"><span class="pre">datasets.extraction.extraction_functions.</span></span><span class="sig-name descname"><span class="pre">extract_timeseries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subject_events</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subject_diagnoses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subject_icu_history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmap_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/extraction_functions.html#extract_timeseries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.extraction_functions.extract_timeseries" title="Link to this definition"></a></dt>
<dd><p>Processes subject events, diagnoses, and ICU history into time series and episodic data.</p>
<p>This method retrieves the ICU history, diagnoses, and events data for each subject. It merges the events data
with variable mappings, sorts the ICU stays by admission and discharge times, and extracts diagnosis labels and
general patient data for each ICU stay. These are then stored in the episodic_data_df. The method then cleans and processes the events data</p>
<blockquote>
<div><p>(e.g. convert to same metric units, remove null values),</p>
</div></blockquote>
<p>extracts time series data for each variable of interest, per episode. It extracts hourly indexed time
series data and retrieves static values such as weight and height for each ICU stay. Finally, the episodic and timeseries
data are stored in the subject directory.</p>
<dl class="simple">
<dt><strong>Episodic data</strong> includes the following information for each ICU stay:</dt><dd><ul class="simple">
<li><p>ICU Stay ID</p></li>
<li><p>Age</p></li>
<li><p>Length of Stay (LOS)</p></li>
<li><p>Mortality</p></li>
<li><p>Gender</p></li>
<li><p>Ethnicity</p></li>
<li><p>Height</p></li>
<li><p>Weight</p></li>
<li><p>Diagnoses binaries as columns</p></li>
</ul>
</dd>
<dt><strong>Time series</strong> variables of interest are:</dt><dd><ul class="simple">
<li><p>Capillary refill rate</p></li>
<li><p>Diastolic blood pressure</p></li>
<li><p>Fraction inspired oxygen</p></li>
<li><p>Glascow coma scale eye opening</p></li>
<li><p>Glascow coma scale motor response</p></li>
<li><p>Glascow coma scale total</p></li>
<li><p>Glascow coma scale verbal response</p></li>
<li><p>Glucose</p></li>
<li><p>Heart Rate</p></li>
<li><p>Height</p></li>
<li><p>Mean blood pressure</p></li>
<li><p>Oxygen saturation</p></li>
<li><p>pH</p></li>
<li><p>Respiratory rate</p></li>
<li><p>Systolic blood pressure</p></li>
<li><p>Temperature</p></li>
<li><p>Weight</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subject_events</strong> (<em>dict</em>) – Dictionary containing chart and laboratory events per subject.</p></li>
<li><p><strong>subject_diagnoses</strong> (<em>dict</em>) – Dictionary containing diagnoses per ICU stay per patient.</p></li>
<li><p><strong>subject_icu_history</strong> (<em>dict</em>) – Dictionary containing ICU history per subject.</p></li>
<li><p><strong>varmap_df</strong> (<em>pd.DataFrame</em>) – DataFrame containing variable mappings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>episodic_data<span class="classifier">dict</span></dt><dd><p>Dictionary describing each ICU stay.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>timeseries<span class="classifier">dict</span></dt><dd><p>Dictionary containing time series of events over time for each ICU stay.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-datasets.extraction.progress_publisher">
<span id="datasets-extraction-progress-publisher-module"></span><h2>datasets.extraction.progress_publisher module<a class="headerlink" href="#module-datasets.extraction.progress_publisher" title="Link to this heading"></a></h2>
<section id="id5">
<h3>Dataset Extraction Module<a class="headerlink" href="#id5" title="Link to this heading"></a></h3>
<p>This module provides a class for publishing the progress of the event processing.
This class is used for multiprocessing and employed by the iterative extraction.</p>
<section id="id6">
<h4>Classes<a class="headerlink" href="#id6" title="Link to this heading"></a></h4>
<ul>
<li><dl>
<dt>ProgressPublisher(n_consumers, source_path, in_q, tracker)</dt><dd><p>Publishes the progress of the event processing.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">multiprocess</span> <span class="kn">import</span> <span class="n">JoinableQueue</span><span class="p">,</span> <span class="n">Lock</span>
<span class="kn">from</span> <span class="nn">..trackers</span> <span class="kn">import</span> <span class="n">ExtractionTracker</span>

<span class="c1"># Initialize parameters</span>
<span class="n">source_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;/path/to/source&#39;</span><span class="p">)</span>
<span class="n">storage_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;/path/to/storage&#39;</span><span class="p">)</span>
<span class="n">in_q</span> <span class="o">=</span> <span class="n">JoinableQueue</span><span class="p">()</span>
<span class="n">out_q</span> <span class="o">=</span> <span class="n">JoinableQueue</span><span class="p">()</span>
<span class="n">icu_history_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/path/to/icu_history.csv&#39;</span><span class="p">)</span>
<span class="n">lock</span> <span class="o">=</span> <span class="n">Lock</span><span class="p">()</span>
<span class="n">tracker</span> <span class="o">=</span> <span class="n">ExtractionTracker</span><span class="p">(</span><span class="n">storage_path</span><span class="p">)</span>

<span class="c1"># Create and start the progress publisher</span>
<span class="n">progress_publisher</span> <span class="o">=</span> <span class="n">ProgressPublisher</span><span class="p">(</span><span class="n">n_consumers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                                       <span class="n">source_path</span><span class="o">=</span><span class="n">source_path</span><span class="p">,</span>
                                       <span class="n">in_q</span><span class="o">=</span><span class="n">out_q</span><span class="p">,</span>
                                       <span class="n">tracker</span><span class="o">=</span><span class="n">tracker</span><span class="p">)</span>
<span class="n">progress_publisher</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="c1"># Create and start the event consumer</span>
<span class="n">consumer</span> <span class="o">=</span> <span class="n">EventConsumer</span><span class="p">(</span><span class="n">storage_path</span><span class="o">=</span><span class="n">storage_path</span><span class="p">,</span>
                         <span class="n">in_q</span><span class="o">=</span><span class="n">in_q</span><span class="p">,</span>
                         <span class="n">out_q</span><span class="o">=</span><span class="n">out_q</span><span class="p">,</span>
                         <span class="n">icu_history_df</span><span class="o">=</span><span class="n">icu_history_df</span><span class="p">,</span>
                         <span class="n">lock</span><span class="o">=</span><span class="n">lock</span><span class="p">)</span>
<span class="n">consumer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="c1"># Read and process events</span>
<span class="n">event_reader</span> <span class="o">=</span> <span class="n">EventReader</span><span class="p">(</span><span class="n">dataset_folder</span><span class="o">=</span><span class="s1">&#39;/path/to/data&#39;</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">event_frames</span><span class="p">,</span> <span class="n">frame_lengths</span> <span class="o">=</span> <span class="n">event_reader</span><span class="o">.</span><span class="n">get_chunk</span><span class="p">()</span>
<span class="n">events_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">event_frames</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">in_q</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">events_df</span><span class="p">,</span> <span class="n">frame_lengths</span><span class="p">))</span>

<span class="n">Processed</span> <span class="n">event</span> <span class="n">rows</span><span class="p">:</span>
<span class="n">CHARTEVENTS</span><span class="p">:</span>    <span class="mi">1000</span><span class="o">/</span><span class="mi">5000</span>
<span class="n">LABEVENTS</span><span class="p">:</span>      <span class="mi">1000</span><span class="o">/</span><span class="mi">6000</span>
<span class="n">OUTPUTEVENTS</span><span class="p">:</span>   <span class="mi">1000</span><span class="o">/</span><span class="mi">4500</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</section>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="datasets.extraction.progress_publisher.ProgressPublisher">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datasets.extraction.progress_publisher.</span></span><span class="sig-name descname"><span class="pre">ProgressPublisher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_consumers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">JoinableQueue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracker</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="datasets.html#datasets.trackers.ExtractionTracker" title="datasets.trackers.ExtractionTracker"><span class="pre">ExtractionTracker</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/progress_publisher.html#ProgressPublisher"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.progress_publisher.ProgressPublisher" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Process</span></code></p>
<p>Publishes the progress of the event processing to the command line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_consumers</strong> (<em>int</em>) – Number of consumer processes.</p></li>
<li><p><strong>source_path</strong> (<em>Path</em>) – Path to the source directory containing the raw data files.</p></li>
<li><p><strong>in_q</strong> (<em>JoinableQueue</em>) – Queue from which to read the progress updates.</p></li>
<li><p><strong>tracker</strong> (<a class="reference internal" href="datasets.html#datasets.trackers.ExtractionTracker" title="datasets.trackers.ExtractionTracker"><em>ExtractionTracker</em></a>) – Tracker to keep track of extraction progress.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="datasets.extraction.progress_publisher.ProgressPublisher.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/progress_publisher.html#ProgressPublisher.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.progress_publisher.ProgressPublisher.run" title="Link to this definition"></a></dt>
<dd><p>Runs the progress publisher, updating and printing the progress.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasets.extraction.progress_publisher.ProgressPublisher.start">
<span class="sig-name descname"><span class="pre">start</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/progress_publisher.html#ProgressPublisher.start"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.progress_publisher.ProgressPublisher.start" title="Link to this definition"></a></dt>
<dd><p>Starts the progress publisher process.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="datasets.extraction.progress_publisher.ProgressPublisher.join">
<span class="sig-name descname"><span class="pre">join</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/progress_publisher.html#ProgressPublisher.join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.progress_publisher.ProgressPublisher.join" title="Link to this definition"></a></dt>
<dd><p>Joins the progress publisher process.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">join</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/progress_publisher.html#ProgressPublisher.join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd><p>Wait until child process terminates</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/progress_publisher.html#ProgressPublisher.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd><p>Method to be run in sub-process; can be overridden in sub-class</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">start</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/progress_publisher.html#ProgressPublisher.start"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id9" title="Link to this definition"></a></dt>
<dd><p>Start child process</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-datasets.extraction.timeseries_processor">
<span id="datasets-extraction-timeseries-processor-module"></span><h2>datasets.extraction.timeseries_processor module<a class="headerlink" href="#module-datasets.extraction.timeseries_processor" title="Link to this heading"></a></h2>
<p>This module provides the TimeseriesProcessor class for processing time series data from ICU records.
It reads and processes subject event data, diagnoses, and ICU history to generate time series and episodic data.
The timeseries and episodic data are stored in the subject ID labeled directories, while the episodic info is
condensed into a single CSV file.</p>
<section id="id10">
<h3>Classes<a class="headerlink" href="#id10" title="Link to this heading"></a></h3>
<ul class="simple">
<li><dl class="simple">
<dt>TimeseriesProcessor(storage_path, source_path, tracker, subject_ids, diagnoses_df, icu_history_df, varmap_df, num_samples)</dt><dd><p>Processes time series data for given subjects and stores the results.</p>
</dd>
</dl>
</li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">..trackers</span> <span class="kn">import</span> <span class="n">ExtractionTracker</span>
<span class="kn">from</span> <span class="nn">datasets.extraction</span> <span class="kn">import</span> <span class="n">get_by_subject</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Initialize parameters</span>
<span class="n">storage_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;/path/to/storage&#39;</span><span class="p">)</span>
<span class="n">source_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;/path/to/source&#39;</span><span class="p">)</span>
<span class="n">tracker</span> <span class="o">=</span> <span class="n">ExtractionTracker</span><span class="p">(</span><span class="n">storage_path</span><span class="p">)</span>
<span class="n">subject_ids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">123</span><span class="p">,</span> <span class="mi">456</span><span class="p">,</span> <span class="mi">789</span><span class="p">]</span>
<span class="n">diagnoses_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/path/to/diagnoses.csv&#39;</span><span class="p">)</span>
<span class="n">icu_history_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/path/to/icu_history.csv&#39;</span><span class="p">)</span>
<span class="n">varmap_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/path/to/varmap.csv&#39;</span><span class="p">)</span>
<span class="n">num_samples</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Prepare subject-specific data</span>
<span class="n">subject_diagnoses</span> <span class="o">=</span> <span class="n">get_by_subject</span><span class="p">(</span><span class="n">diagnoses_df</span><span class="p">)</span>
<span class="n">subject_icu_history</span> <span class="o">=</span> <span class="n">get_by_subject</span><span class="p">(</span><span class="n">icu_history_df</span><span class="p">)</span>

<span class="c1"># Create and run the processor</span>
<span class="n">processor</span> <span class="o">=</span> <span class="n">TimeseriesProcessor</span><span class="p">(</span><span class="n">storage_path</span><span class="p">,</span> <span class="n">source_path</span><span class="p">,</span> <span class="n">tracker</span><span class="p">,</span> <span class="n">subject_ids</span><span class="p">,</span> <span class="n">diagnoses_df</span><span class="p">,</span> <span class="n">icu_history_df</span><span class="p">,</span> <span class="n">varmap_df</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">)</span>
<span class="n">processor</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="datasets.extraction.timeseries_processor.TimeseriesProcessor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">datasets.extraction.timeseries_processor.</span></span><span class="sig-name descname"><span class="pre">TimeseriesProcessor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">storage_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracker</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="datasets.html#datasets.trackers.ExtractionTracker" title="datasets.trackers.ExtractionTracker"><span class="pre">ExtractionTracker</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">subject_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagnoses_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icu_history_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varmap_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/timeseries_processor.html#TimeseriesProcessor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.timeseries_processor.TimeseriesProcessor" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="datasets.extraction.timeseries_processor.TimeseriesProcessor.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction/timeseries_processor.html#TimeseriesProcessor.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.timeseries_processor.TimeseriesProcessor.run" title="Link to this definition"></a></dt>
<dd><p>Runs the time series processing using multiprocessing.</p>
<p>This method initializes a multiprocessing pool to process subjects in parallel,
generating episodic and time series data for each subject and storing the results.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">processor</span> <span class="o">=</span> <span class="n">TimeseriesProcessor</span><span class="p">(</span><span class="n">storage_path</span><span class="p">,</span> <span class="n">source_path</span><span class="p">,</span> <span class="n">tracker</span><span class="p">,</span> <span class="n">subject_ids</span><span class="p">,</span> <span class="n">diagnoses_df</span><span class="p">,</span> <span class="n">icu_history_df</span><span class="p">,</span> <span class="n">varmap_df</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">processor</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-datasets.extraction">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-datasets.extraction" title="Link to this heading"></a></h2>
<section id="id11">
<h3>Dataset Extraction Module<a class="headerlink" href="#id11" title="Link to this heading"></a></h3>
<p>This module provides functions and classes for extracting and processing dataset files.
It supports both compact and iterative extraction methods to handle different use cases.</p>
<section id="functions">
<h4>Functions<a class="headerlink" href="#functions" title="Link to this heading"></a></h4>
<ul class="simple">
<li><dl class="simple">
<dt>compact_extraction(storage_path, source_path, num_subjects, num_samples, subject_ids, task)</dt><dd><p>Performs compact extraction of the dataset.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>iterative_extraction(source_path, storage_path, chunksize, num_subjects, num_samples, subject_ids, task)</dt><dd><p>Performs iterative extraction of the dataset.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>read_patients_csv(dataset_folder)</dt><dd><p>Reads the PATIENTS.csv file from the specified dataset folder.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>read_admission_csv(dataset_folder)</dt><dd><p>Reads the ADMISSIONS.csv file from the specified dataset folder.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>read_icustays_csv(dataset_folder)</dt><dd><p>Reads the ICUSTAYS.csv file from the specified dataset folder.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>read_icd9codes_csv(dataset_folder)</dt><dd><p>Reads the D_ICD_DIAGNOSES.csv file from the specified dataset folder.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>read_events_dictionary(dataset_folder)</dt><dd><p>Reads the D_ITEMS.csv file from the specified dataset folder.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>merge_patient_history(patients_df, admissions_df, icustays_df, min_nb_stays, max_nb_stays)</dt><dd><p>Merges patient, admission, and ICU stay data to create a patient history DataFrame.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>make_subject_infos(patients_df, admission_info_df, icustays_df, min_nb_stays, max_nb_stays)</dt><dd><p>Creates a DataFrame containing information about subjects by merging patient, admission, and ICU stay data.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>make_icu_history(patients_df, admissions_df, icustays_df, min_nb_stays, max_nb_stays)</dt><dd><p>Creates a DataFrame describing each ICU stay with admission data, patient data, and mortality.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>make_diagnoses(dataset_folder, icd9codes_df, icu_history_df)</dt><dd><p>Creates a DataFrame containing descriptions of diagnoses with direct links to subjects and ICU stays.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>make_phenotypes(diagnoses_df, definition_map)</dt><dd><p>Creates a binary matrix with diagnoses over ICU stays.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>get_by_subject(df, sort_by)</dt><dd><p>Groups events by subject ID.</p>
</dd>
</dl>
</li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">extraction_module</span> <span class="kn">import</span> <span class="n">compact_extraction</span><span class="p">,</span> <span class="n">iterative_extraction</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">storage_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/path/to/storage&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/path/to/source&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset_dict</span> <span class="o">=</span> <span class="n">compact_extraction</span><span class="p">(</span><span class="n">storage_path</span><span class="p">,</span> <span class="n">source_path</span><span class="p">,</span> <span class="n">num_subjects</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reader</span> <span class="o">=</span> <span class="n">iterative_extraction</span><span class="p">(</span><span class="n">source_path</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="datasets.extraction.compact_extraction">
<span class="sig-prename descclassname"><span class="pre">datasets.extraction.</span></span><span class="sig-name descname"><span class="pre">compact_extraction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">storage_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_subjects</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subject_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/datasets/extraction.html#compact_extraction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.compact_extraction" title="Link to this definition"></a></dt>
<dd><p>Perform single shot extraction of the dataset from the original source. Ensure enough RAM is available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>storage_path</strong> (<em>Path</em>) – The path to the storage directory where the extracted data will be saved.</p></li>
<li><p><strong>source_path</strong> (<em>Path</em>) – The path to the source directory containing the raw data files.</p></li>
<li><p><strong>num_subjects</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of subjects to extract. If None, all subjects are extracted. Default is None.</p></li>
<li><p><strong>num_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of samples to extract. If None, all samples are extracted. Default is None.</p></li>
<li><p><strong>subject_ids</strong> (<em>list</em><em> of </em><em>int</em><em>, </em><em>optional</em>) – List of subject IDs to extract. If None, all subjects are extracted. Default is None.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>optional</em>) – Specific task to extract data for. If None, all tasks are extracted. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the extracted data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">storage_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/path/to/storage&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/path/to/source&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">compact_extraction</span><span class="p">(</span><span class="n">storage_path</span><span class="p">,</span> <span class="n">source_path</span><span class="p">,</span> <span class="n">num_subjects</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="datasets.extraction.create_split_info_csv">
<span class="sig-prename descclassname"><span class="pre">datasets.extraction.</span></span><span class="sig-name descname"><span class="pre">create_split_info_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">episodic_info_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subject_info_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction.html#create_split_info_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.create_split_info_csv" title="Link to this definition"></a></dt>
<dd><p>Create the information used by the dataset split function to split the subjects into demographics groups.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="datasets.extraction.get_by_subject">
<span class="sig-prename descclassname"><span class="pre">datasets.extraction.</span></span><span class="sig-name descname"><span class="pre">get_by_subject</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_by</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction.html#get_by_subject"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.get_by_subject" title="Link to this definition"></a></dt>
<dd><p>Groups events by subject ID.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="datasets.extraction.get_processable_subjects">
<span class="sig-prename descclassname"><span class="pre">datasets.extraction.</span></span><span class="sig-name descname"><span class="pre">get_processable_subjects</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icu_history_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction.html#get_processable_subjects"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.get_processable_subjects" title="Link to this definition"></a></dt>
<dd><p>Get the subject IDs that can be processed for a given task.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="datasets.extraction.get_subject_ids">
<span class="sig-prename descclassname"><span class="pre">datasets.extraction.</span></span><span class="sig-name descname"><span class="pre">get_subject_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icu_history_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subject_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_subjects</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">existing_subjects</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction.html#get_subject_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.get_subject_ids" title="Link to this definition"></a></dt>
<dd><p>Get the subject IDs that can be processed for the given task. Many subjects will need to be
discarded as they do not fulfill the minimum length of stay requirement of 48H for IHM, 4H for DECOMP and LOS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task</strong> (<em>str</em>) – The task for which to get the subject IDs.</p></li>
<li><p><strong>icu_history_df</strong> (<em>pd.DataFrame</em>) – The dataframe containing ICU history information.</p></li>
<li><p><strong>subject_ids</strong> (<em>list</em><em> of </em><em>int</em><em>, </em><em>optional</em>) – List of subject IDs to extract. If None, all subjects are extracted. Default is None.</p></li>
<li><p><strong>num_subjects</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of subjects to extract. If None, all subjects are extracted. Default is None.</p></li>
<li><p><strong>existing_subjects</strong> (<em>list</em><em> of </em><em>int</em><em>, </em><em>optional</em>) – List of existing subjects to exclude from extraction. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the list of subject IDs and the reduced ICU history dataframe.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="datasets.extraction.get_subjects_by_number">
<span class="sig-prename descclassname"><span class="pre">datasets.extraction.</span></span><span class="sig-name descname"><span class="pre">get_subjects_by_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_subjects</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">existing_subjects</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_subjects</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction.html#get_subjects_by_number"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.get_subjects_by_number" title="Link to this definition"></a></dt>
<dd><p>Get a specified number of subject IDs, excluding the existing subjects.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="datasets.extraction.iterative_extraction">
<span class="sig-prename descclassname"><span class="pre">datasets.extraction.</span></span><span class="sig-name descname"><span class="pre">iterative_extraction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunksize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_subjects</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subject_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="datasets.html#datasets.readers.ExtractedSetReader" title="datasets.readers.ExtractedSetReader"><span class="pre">ExtractedSetReader</span></a></span></span><a class="reference internal" href="../_modules/datasets/extraction.html#iterative_extraction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.iterative_extraction" title="Link to this definition"></a></dt>
<dd><p>Perform iterative extraction of the dataset, with specified chunk size. This will require less RAM and run on multiple processes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_path</strong> (<em>Path</em>) – The path to the source directory containing the raw data files.</p></li>
<li><p><strong>storage_path</strong> (<em>Path</em><em>, </em><em>optional</em>) – The path to the storage directory where the extracted data will be saved. Default is None.</p></li>
<li><p><strong>chunksize</strong> (<em>int</em><em>, </em><em>optional</em>) – The size of chunks to read at a time. Default is None.</p></li>
<li><p><strong>num_subjects</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of subjects to extract. If None, all subjects are extracted. Default is None.</p></li>
<li><p><strong>num_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of samples to extract. If None, all samples are extracted. Default is None.</p></li>
<li><p><strong>subject_ids</strong> (<em>list</em><em> of </em><em>int</em><em>, </em><em>optional</em>) – List of subject IDs to extract. If None, all subjects are extracted. Default is None.</p></li>
<li><p><strong>task</strong> (<em>str</em><em>, </em><em>optional</em>) – Specific task to extract data for. If None, all tasks are extracted. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The extracted set reader to access the dataset.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="datasets.html#datasets.readers.ExtractedSetReader" title="datasets.readers.ExtractedSetReader">ExtractedSetReader</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">source_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/path/to/source&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">storage_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/path/to/storage&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reader</span> <span class="o">=</span> <span class="n">iterative_extraction</span><span class="p">(</span><span class="n">source_path</span><span class="p">,</span> <span class="n">storage_path</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">num_subjects</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="datasets.extraction.make_diagnoses">
<span class="sig-prename descclassname"><span class="pre">datasets.extraction.</span></span><span class="sig-name descname"><span class="pre">make_diagnoses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icd9codes_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icu_history_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction.html#make_diagnoses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.make_diagnoses" title="Link to this definition"></a></dt>
<dd><p>Creates a DataFrame containing descriptions of diagnoses with direct links to subjects and ICU stays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset_folder</strong> (<em>str</em>) – Path to the dataset folder. Defaults to ‘data/mimic-iii-demo/’.</p></li>
<li><p><strong>icd9codes_df</strong> (<em>pd.DataFrame</em>) – DataFrame containing ICD-9 code definitions.</p></li>
<li><p><strong>icu_history_df</strong> (<em>pd.DataFrame</em>) – DataFrame containing ICU stay descriptions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>diagnoses_df: DataFrame containing descriptions of diagnoses with links to subjects and ICU stays.</p></li>
<li><p>definition_map: Dictionary mapping ICD-9 codes to phenotypes and benchmark usage.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of pd.DataFrame and dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="datasets.extraction.make_icu_history">
<span class="sig-prename descclassname"><span class="pre">datasets.extraction.</span></span><span class="sig-name descname"><span class="pre">make_icu_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patients_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">admissions_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icustays_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_nb_stays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_nb_stays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="../_modules/datasets/extraction.html#make_icu_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.make_icu_history" title="Link to this definition"></a></dt>
<dd><p>Creates a DataFrame describing each ICU stay with admission data, patient data, and mortality.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patients_df</strong> (<em>pd.DataFrame</em>) – DataFrame containing patient data.</p></li>
<li><p><strong>admissions_df</strong> (<em>pd.DataFrame</em>) – DataFrame containing hospital admissions data.</p></li>
<li><p><strong>icustays_df</strong> (<em>pd.DataFrame</em>) – DataFrame containing ICU stay data.</p></li>
<li><p><strong>min_nb_stays</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum number of ICU stays to include a patient, by default 1.</p></li>
<li><p><strong>max_nb_stays</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of ICU stays to include a patient, by default 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame describing each ICU stay with admission data, patient data, and mortality.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="datasets.extraction.make_phenotypes">
<span class="sig-prename descclassname"><span class="pre">datasets.extraction.</span></span><span class="sig-name descname"><span class="pre">make_phenotypes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diagnoses_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">definition_map</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction.html#make_phenotypes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.make_phenotypes" title="Link to this definition"></a></dt>
<dd><p>Creates a binary matrix with diagnoses over ICU stays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>diagnoses_df</strong> (<em>pd.DataFrame</em>) – DataFrame containing diagnoses descriptions with ICU stay information.</p></li>
<li><p><strong>definition_map</strong> (<em>dict</em>) – Dictionary mapping ICD-9 codes to phenotypes and benchmark usage.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Binary matrix with diagnoses over ICU stays.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="datasets.extraction.make_subject_infos">
<span class="sig-prename descclassname"><span class="pre">datasets.extraction.</span></span><span class="sig-name descname"><span class="pre">make_subject_infos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patients_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">admission_info_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icustays_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_nb_stays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_nb_stays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="../_modules/datasets/extraction.html#make_subject_infos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.make_subject_infos" title="Link to this definition"></a></dt>
<dd><p>Creates a DataFrame containing information about subjects by merging patient, admission, and ICU stay data, like gender and insurance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patients_df</strong> (<em>pd.DataFrame</em>) – DataFrame containing patient data.</p></li>
<li><p><strong>admission_info_df</strong> (<em>pd.DataFrame</em>) – DataFrame containing additional admission information.</p></li>
<li><p><strong>icustays_df</strong> (<em>pd.DataFrame</em>) – DataFrame containing ICU stay data.</p></li>
<li><p><strong>min_nb_stays</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum number of ICU stays to include a patient, by default 1.</p></li>
<li><p><strong>max_nb_stays</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of ICU stays to include a patient, by default 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame containing subject information with specified columns.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Merges patient history data.</p></li>
<li><p>Selects and renames columns according to the configuration.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="datasets.extraction.merge_patient_history">
<span class="sig-prename descclassname"><span class="pre">datasets.extraction.</span></span><span class="sig-name descname"><span class="pre">merge_patient_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patients_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">admissions_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icustays_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_nb_stays</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_nb_stays</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="../_modules/datasets/extraction.html#merge_patient_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.merge_patient_history" title="Link to this definition"></a></dt>
<dd><p>Merges patient, admission, and ICU stay data to create a patient history DataFrame of ICU stays, like admission time and mortality.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patients_df</strong> (<em>pd.DataFrame</em>) – DataFrame containing patient data.</p></li>
<li><p><strong>admissions_df</strong> (<em>pd.DataFrame</em>) – DataFrame containing admission data.</p></li>
<li><p><strong>icustays_df</strong> (<em>pd.DataFrame</em>) – DataFrame containing ICU stay data.</p></li>
<li><p><strong>min_nb_stays</strong> (<em>int</em>) – Minimum number of ICU stays to include a patient.</p></li>
<li><p><strong>max_nb_stays</strong> (<em>int</em>) – Maximum number of ICU stays to include a patient.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Merged DataFrame with patient history.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Only ICU stays where the first and last care unit and ward ID match are included.</p></li>
<li><p>Filters patients based on the number of ICU stays between min_nb_stays and max_nb_stays.</p></li>
<li><p>Calculates patient age and filters out children (age &lt; 18).</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="datasets.extraction.read_admission_csv">
<span class="sig-prename descclassname"><span class="pre">datasets.extraction.</span></span><span class="sig-name descname"><span class="pre">read_admission_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction.html#read_admission_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.read_admission_csv" title="Link to this definition"></a></dt>
<dd><p>Reads the ADMISSIONS.csv file from the specified dataset folder with correct dtypes and columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataset_folder</strong> (<em>Path</em>) – Path to the dataset folder. Defaults to ‘data/mimic-iii-demo/’.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>admissions_df: DataFrame with hospital admissions data including admission, discharge, type, and location.</p></li>
<li><p>admissions_info_df: DataFrame with additional admission information.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Column names are converted to uppercase.</p></li>
<li><p>Columns specified in the configuration are selected.</p></li>
<li><p>Date columns are converted to datetime.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="datasets.extraction.read_events_dictionary">
<span class="sig-prename descclassname"><span class="pre">datasets.extraction.</span></span><span class="sig-name descname"><span class="pre">read_events_dictionary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction.html#read_events_dictionary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.read_events_dictionary" title="Link to this definition"></a></dt>
<dd><p>Reads the D_ITEMS.csv file from the specified dataset folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataset_folder</strong> (<em>Path</em>) – Path to the dataset folder. Defaults to ‘data/mimic-iii-demo/’.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame containing the items dictionary with ITEMID and DBSOURCE columns.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Column names are converted to uppercase.</p></li>
<li><p>Only the ITEMID and DBSOURCE columns are selected.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="datasets.extraction.read_icd9codes_csv">
<span class="sig-prename descclassname"><span class="pre">datasets.extraction.</span></span><span class="sig-name descname"><span class="pre">read_icd9codes_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction.html#read_icd9codes_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.read_icd9codes_csv" title="Link to this definition"></a></dt>
<dd><p>Reads the D_ICD_DIAGNOSES.csv file from the specified dataset folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataset_folder</strong> (<em>Path</em>) – Path to the dataset folder. Defaults to ‘data/mimic-iii-demo/’.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame with dictionaries describing the ICD9 codes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Column names are converted to uppercase.</p></li>
<li><p>Columns specified in the configuration are selected.</p></li>
<li><p>International Classification of Diseases, Ninth Revision, are alphanumeric codes used by healthcare providers to classify and code all diagnoses, symptoms, and procedures recorded in conjunction with hospital care in the United States</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="datasets.extraction.read_icustays_csv">
<span class="sig-prename descclassname"><span class="pre">datasets.extraction.</span></span><span class="sig-name descname"><span class="pre">read_icustays_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction.html#read_icustays_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.read_icustays_csv" title="Link to this definition"></a></dt>
<dd><p>Reads the ICUSTAYS.csv file from the specified dataset folder with correct dtypes and columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataset_folder</strong> (<em>Path</em>) – Path to the dataset folder. Defaults to ‘data/mimic-iii-demo/’.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame with ICU admission data including first &amp; last care unit, ward ID, etc.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Column names are converted to uppercase.</p></li>
<li><p>Columns specified in the configuration are selected.</p></li>
<li><p>Date columns are converted to datetime.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="datasets.extraction.read_patients_csv">
<span class="sig-prename descclassname"><span class="pre">datasets.extraction.</span></span><span class="sig-name descname"><span class="pre">read_patients_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction.html#read_patients_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.read_patients_csv" title="Link to this definition"></a></dt>
<dd><p>Reads the PATIENTS.csv file from the specified dataset folder with correct dtypes and columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataset_folder</strong> (<em>Path</em>) – Path to the dataset folder. Defaults to ‘data/mimic-iii-demo/’.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame containing patient data including birth, death, gender, and ethnicity.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Column names are converted to uppercase.</p></li>
<li><p>Columns specified in the configuration are selected.</p></li>
<li><p>Date columns are converted to datetime.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="datasets.extraction.reduce_by_subjects">
<span class="sig-prename descclassname"><span class="pre">datasets.extraction.</span></span><span class="sig-name descname"><span class="pre">reduce_by_subjects</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subject_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/datasets/extraction.html#reduce_by_subjects"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#datasets.extraction.reduce_by_subjects" title="Link to this definition"></a></dt>
<dd><p>Reduce the dataframe to only include the specified subject IDs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> (<em>pd.DataFrame</em>) – The dataframe to reduce.</p></li>
<li><p><strong>subject_ids</strong> (<em>list</em>) – The list of subject IDs to retain in the dataframe.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The reduced dataframe containing only the specified subject IDs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;SUBJECT_ID&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10006</span><span class="p">,</span> <span class="mi">10011</span><span class="p">,</span> <span class="mi">10019</span><span class="p">],</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reduce_by_subjects</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="mi">10006</span><span class="p">,</span> <span class="mi">10019</span><span class="p">])</span>
<span class="go">   SUBJECT_ID  value</span>
<span class="go">0           10006     10</span>
<span class="go">2           10019     30</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="datasets.html" class="btn btn-neutral float-left" title="datasets package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="datasets.processors.html" class="btn btn-neutral float-right" title="datasets.processors package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Amadou Wolfgang Cisse.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>